



sbatch code/analysis/map.batch \
	lr-even \
	canu \
	test2 \
	data/raw/lr-even/lr-even_raw.fastq \
	data/raven/lr-even/test2/medaka_consensus_simple_run/consensus.fasta


## canu
sbatch code/analysis/map.batch lr-even canu test1 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even canu test2 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even canu test3 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even canu test4 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even canu test5 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test5/medaka_consensus_simple_run/consensus.fasta


## metaflye
sbatch code/analysis/map.batch lr-even metaflye test1 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even metaflye test2 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even metaflye test3 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even metaflye test4 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even metaflye test5 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test5/medaka_consensus_simple_run/consensus.fasta


## raven
sbatch code/analysis/map.batch lr-even raven test1 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even raven test2 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even raven test3 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even raven test4 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-even raven test5 data/raw/lr-even/lr-even_raw.fastq data/raven/lr-even/test5/medaka_consensus_simple_run/consensus.fasta




###### lr-log
## canu
sbatch code/analysis/map.batch lr-log canu test1 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log canu test2 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log canu test3 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log canu test4 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log canu test5 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test5/medaka_consensus_simple_run/consensus.fasta


## metaflye
sbatch code/analysis/map.batch lr-log metaflye test1 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log metaflye test2 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log metaflye test3 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log metaflye test4 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log metaflye test5 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test5/medaka_consensus_simple_run/consensus.fasta


## raven
sbatch code/analysis/map.batch lr-log raven test1 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log raven test2 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log raven test3 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log raven test4 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-log raven test5 data/raw/lr-log/lr-log_raw.fastq data/raven/lr-log/test5/medaka_consensus_simple_run/consensus.fasta






###### lr-ms
## canu
sbatch code/analysis/map.batch lr-ms canu test1 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms canu test2 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms canu test3 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms canu test4 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms canu test5 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test5/medaka_consensus_simple_run/consensus.fasta


## metaflye
sbatch code/analysis/map.batch lr-ms metaflye test1 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms metaflye test2 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms metaflye test3 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms metaflye test4 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms metaflye test5 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test5/medaka_consensus_simple_run/consensus.fasta


## raven
sbatch code/analysis/map.batch lr-ms raven test1 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test1/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms raven test2 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test2/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms raven test3 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test3/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms raven test4 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test4/medaka_consensus_simple_run/consensus.fasta
sbatch code/analysis/map.batch lr-ms raven test5 data/raw/lr-ms/lr-ms_raw.fastq data/raven/lr-ms/test5/medaka_consensus_simple_run/consensus.fasta














grep '^>' data/raven/lr-ms/test5/medaka_consensus_simple_run/consensus.fasta | sed 's/^>//' > data/raven/lr-ms/test5/map/raven_lr-ms_test5_filtered-contig-id.txt

seqtk subseq data/raven/lr-ms/test5/map/raven_lr-ms_test5_mapped_sorted.fastq data/raven/lr-ms/test5/map/raven_lr-ms_test5_filtered-contig-id.txt > data/raven/lr-ms/test5/map/final-contigs.fastq








# Step 1: Extract contig and read IDs from the SAM file
awk '{if($1 !~ /^@/) print $1, $3}' data/raven/lr-ms/test5/map/raven_lr-ms_test5_mapped_sorted.bam > data/raven/lr-ms/test5/map/raven_lr-ms_test5_contig_read_mapping.txt

# Step 2: Create a mapping of contig IDs to read IDs
awk '{print $2}' data/raven/lr-ms/test5/map/raven_lr-ms_test5_contig_read_mapping.txt | sort | uniq > data/raven/lr-ms/test5/map/raven_lr-ms_test5_contig_read_id.txt

# Step 3: Filter the FASTQ file using the read IDs
seqtk subseq data/raven/lr-ms/test5/map/raven_lr-ms_test5_mapped_sorted.fastq contig_ids.txt > data/raven/lr-ms/test5/map/final-contigs.fastq
